<!--pages/my-posts/my-posts.wxml-->
<view class="container">
  <!-- é¡µé¢æ ‡é¢˜ -->
  <view class="page-header">
    <text class="page-title">æˆ‘çš„å¸–å­</text>
    <text class="post-count">å…± {{total}} æ¡</text>
  </view>

  <!-- å¸–å­åˆ—è¡¨ -->
  <view class="posts-list" wx:if="{{posts.length > 0}}">
    <view 
      class="post-item card" 
      wx:for="{{posts}}" 
      wx:key="id"
      bindtap="onPostTap"
      data-post="{{item}}"
    >
      <!-- å¸–å­å¤´éƒ¨ -->
      <view class="post-header">
        <view class="post-meta">
          <text class="post-time">{{item.createdAt}}</text>
          <view class="post-category" wx:if="{{item.categoryName}}">{{item.categoryName}}</view>
          <view class="post-status {{item.status === 'published' ? 'published' : 'draft'}}">
            {{item.status === 'published' ? 'å·²å‘å¸ƒ' : 'è‰ç¨¿'}}
          </view>
        </view>
        <view class="post-actions">
          <text class="action-btn delete-btn" catchtap="onDeletePost" data-id="{{item.id}}">åˆ é™¤</text>
        </view>
      </view>

      <!-- å¸–å­å†…å®¹ -->
      <view class="post-content">
        <text class="post-title">{{item.title}}</text>
        <text class="post-excerpt">{{item.content}}</text>
      </view>

      <!-- å¸–å­å›¾ç‰‡ -->
      <view class="post-images" wx:if="{{item.images && item.images.length > 0}}">
        <image 
          class="post-image" 
          wx:for="{{item.images}}" 
          wx:for-item="image" 
          wx:key="*this"
          src="{{image}}"
          mode="aspectFill"
          bindtap="onImageTap"
          data-url="{{image}}"
        />
      </view>

      <!-- å¸–å­ç»Ÿè®¡ -->
      <view class="post-stats">
        <view class="stat-item">
          <text class="stat-icon">ğŸ‘ï¸</text>
          <text class="stat-number">{{item.viewCount || 0}}</text>
        </view>
        <view class="stat-item">
          <text class="stat-icon">â¤ï¸</text>
          <text class="stat-number">{{item.likeCount || 0}}</text>
        </view>
        <view class="stat-item">
          <text class="stat-icon">ğŸ’¬</text>
          <text class="stat-number">{{item.commentCount || 0}}</text>
        </view>
      </view>
    </view>
  </view>

  <!-- æœªç™»å½•çŠ¶æ€ -->
  <view class="auth-state" wx:if="{{!hasUserInfo}}">
    <view class="auth-icon">ğŸ”</view>
    <text class="auth-title">éœ€è¦ç™»å½•</text>
    <text class="auth-desc">æŸ¥çœ‹æˆ‘çš„å¸–å­éœ€è¦å…ˆç™»å½•è´¦å·</text>
    <button class="btn btn-primary" bindtap="onGoToLogin">å»ç™»å½•</button>
  </view>

  <!-- ç©ºçŠ¶æ€ -->
  <view class="empty-state" wx:if="{{posts.length === 0 && !loading && hasUserInfo}}">
    <view class="empty-icon">ğŸ“</view>
    <text class="empty-title">è¿˜æ²¡æœ‰å‘å¸ƒè¿‡å¸–å­</text>
    <text class="empty-desc">å¿«å»å‘å¸ƒä½ çš„ç¬¬ä¸€ä¸ªå¸–å­å§ï¼</text>
    <button class="btn btn-primary" bindtap="onCreatePost">å‘å¸ƒå¸–å­</button>
  </view>

  <!-- åŠ è½½çŠ¶æ€ -->
  <view class="loading-state" wx:if="{{loading}}">
    <text class="loading-text">åŠ è½½ä¸­...</text>
  </view>

  <!-- åŠ è½½æ›´å¤š -->
  <view class="load-more" wx:if="{{hasMore && !loading && posts.length > 0}}">
    <text class="load-more-text" bindtap="onLoadMore">åŠ è½½æ›´å¤š</text>
  </view>

  <!-- æ²¡æœ‰æ›´å¤šæ•°æ® -->
  <view class="no-more" wx:if="{{!hasMore && posts.length > 0}}">
    <text class="no-more-text">æ²¡æœ‰æ›´å¤šæ•°æ®äº†</text>
  </view>
</view>
